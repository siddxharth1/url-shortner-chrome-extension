import{f as l,x as W,o as S,j as e,a as d,y as _,c as E,u as V,G as R,b as z,B as p,O as w,L as C,Q as M,k,h as L,r as b,d as O,e as P,H as v,T as u}from"./index-igr5BrDM.js";import{a as I}from"./index-vil9ThEs.js";var A=l(function(t,a){const{borderLeftWidth:n,borderBottomWidth:o,borderTopWidth:i,borderRightWidth:r,borderWidth:c,borderStyle:j,borderColor:g,...f}=W("Divider",t),{className:x,orientation:T="horizontal",__css:N,...D}=S(t),B={vertical:{borderLeftWidth:n||r||c||"1px",height:"100%"},horizontal:{borderBottomWidth:o||i||c||"1px",width:"100%"}};return e.jsx(d.hr,{ref:a,"aria-orientation":T,...D,__css:{...f,border:"0",borderColor:g,borderStyle:j,...B[T],...N},className:_("chakra-divider",x)})});A.displayName="Divider";var[X,y]=E({name:"TableStylesContext",errorMessage:`useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Table />" `}),H=l((s,t)=>{const a=V("Table",s),{className:n,layout:o,...i}=S(s);return e.jsx(X,{value:a,children:e.jsx(d.table,{ref:t,__css:{tableLayout:o,...a.table},className:_("chakra-table",n),...i})})});H.displayName="Table";var Y=l((s,t)=>{const a=y();return e.jsx(d.thead,{...s,ref:t,__css:a.thead})}),U=l((s,t)=>{const a=y();return e.jsx(d.tr,{...s,ref:t,__css:a.tr})}),$=l((s,t)=>{var a;const{overflow:n,overflowX:o,className:i,...r}=s;return e.jsx(d.div,{ref:t,className:_("chakra-table__container",i),...r,__css:{display:"block",whiteSpace:"nowrap",WebkitOverflowScrolling:"touch",overflowX:(a=n??o)!=null?a:"auto",overflowY:"hidden",maxWidth:"100%"}})}),F=l((s,t)=>{const a=y();return e.jsx(d.tbody,{...s,ref:t,__css:a.tbody})}),h=l(({isNumeric:s,...t},a)=>{const n=y();return e.jsx(d.td,{...t,ref:a,__css:n.td,"data-is-numeric":s})}),m=l(({isNumeric:s,...t},a)=>{const n=y();return e.jsx(d.th,{...t,ref:a,__css:n.th,"data-is-numeric":s})});function G(s){return R({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"},child:[]}]})(s)}function J(s){return R({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"},child:[]}]})(s)}const Q=({urls:s,setUrls:t})=>{const{user:a}=z(),n=r=>{navigator.clipboard.writeText(w+"/"+r.shortURL),k("Link copied to clipboard!")},o=window.location.origin.includes("chrome-extension")||window.location.origin.includes("moz-extension"),i=async r=>{const c=await fetch(L+"/api/url",{method:"DELETE",headers:{"Content-Type":"application/json",token:a.token},body:JSON.stringify({id:r})}),j=await c.json();if(c.status===400){k(j.resp,{type:"error"});return}c.ok&&t(s.filter(g=>g._id!==r)),k("URL deleted successfully!")};return e.jsxs(p,{p:1,style:{border:"1px solid grey",borderRadius:"12px",margin:"20px 0"},children:[e.jsx($,{overflowX:"auto",w:{base:"80vw",lg:"100%"},children:e.jsxs(H,{size:{base:"sm",md:"md",lg:"lg"},children:[e.jsx(Y,{children:e.jsxs(U,{children:[e.jsx(m,{children:"Sr. no."}),e.jsx(m,{children:"Short URL"}),e.jsx(m,{children:"Original URL"}),e.jsx(m,{textAlign:"center",isNumeric:!0,children:"Clicks"}),e.jsx(m,{textAlign:"center",children:"Date"}),e.jsx(m,{textAlign:"center",children:"Analytics"})]})}),e.jsx(F,{children:s.map((r,c)=>e.jsxs(U,{children:[e.jsx(h,{children:c+1}),e.jsx(h,{children:e.jsxs(p,{style:{display:"flex",gap:"10px"},children:[w+"/"+r.shortURL,e.jsx(G,{style:{cursor:"pointer"},onClick:()=>{n(r)}})]})}),e.jsx(h,{children:e.jsx(p,{width:"300px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:e.jsx("a",{target:"_blank",href:r.originalURL,children:r.originalURL})})}),e.jsx(h,{textAlign:"center",children:r.visitHistory.length}),e.jsx(h,{textAlign:"center",children:r.createdAt.substring(0,10)}),e.jsx(h,{textAlign:"center",children:o?e.jsx("a",{href:`${w}/analytics/${r.shortURL}`,target:"_blank",style:{color:"blue"},children:"view"}):e.jsx(C,{to:`/analytics/${r.shortURL}`,children:"view"})}),e.jsx(h,{p:0,children:e.jsx(J,{onClick:()=>{i(r._id)},style:{cursor:"pointer",color:"red",margin:"0px",fontSize:"23px"}})})]},r._id))})]})}),e.jsx(M,{stacked:!0,position:"bottom-right",autoClose:2e3,progressStyle:{background:"green"}})]})},Z=()=>{const{user:s}=z(),[t,a]=b.useState(null),[n,o]=b.useState([]),[i,r]=b.useState(!1),c=O();return b.useEffect(()=>{const j=async()=>{if(r(!0),!(s!=null&&s.token))return;console.log("fetching urls");const x=await(await fetch(L+"/api/url",{headers:{token:s.token}})).json();console.log(x),o(x),r(!1)},g=async()=>{const x=await(await fetch(L+"/user/userInfo",{headers:{token:s.token}})).json();a(x)};s&&(j(),g())},[s]),e.jsxs(p,{mx:"6vw",children:[e.jsx(P,{onClick:()=>c(-1),children:e.jsx(I,{})}),e.jsx(v,{as:"h1",size:"md",my:4,children:"Profile"}),i&&e.jsx(v,{mt:5,children:"Loading..."}),!i&&t&&e.jsxs(p,{children:[e.jsxs(u,{as:"h3",size:"sm",my:2,children:["Name: ",t.data.name]}),e.jsxs(u,{as:"h3",size:"sm",my:2,children:["Email: ",t.data.email]}),e.jsxs(u,{as:"h3",size:"sm",my:2,children:["Created At: ",t.data.createdAt]}),e.jsxs(u,{as:"h3",size:"sm",my:2,children:["Updated At: ",t.data.updatedAt]}),e.jsxs(u,{as:"h3",size:"sm",my:2,children:["Total Links Created: ",t.numberOfUrlsCreated]}),e.jsxs(u,{as:"h3",size:"sm",my:2,children:["Premium:"," ",t.data.premiumUser?"Yes":e.jsxs(e.Fragment,{children:['"No" - ',e.jsx(C,{to:"/premium",children:" Upgrade to Premium"})]})]})]}),e.jsx(A,{borderColor:"black",my:10}),e.jsx(v,{as:"h1",size:"md",children:"Analytics"}),!i&&n.length===0&&e.jsx(v,{children:"No URLs Shortned Yet!"}),!i&&n.length!==0&&e.jsx(Q,{urls:n,setUrls:o})]})};export{Z as default};
