import{q as W,r as o,f as Q,j as e,s as ie,c as ce,t as ue,v as H,w as de,x as pe,o as fe,g as he,a as me,y as xe,h as Z,d as ge,F as Y,z as L,C as O,H as ee,l as V,e as ne,i as ye,k as q,B as je,m as B,T as ve,L as Ce,Q as Pe}from"./index-igr5BrDM.js";import{S as F}from"./chunk-ZHMYA64R-UO2GOftq.js";import{F as M}from"./chunk-H46NUPBZ-Y3HOxHsC.js";function be(n){const{value:s,defaultValue:a,onChange:r,shouldUpdate:f=(p,j)=>p!==j}=n,i=W(r),u=W(f),[d,x]=o.useState(a),y=s!==void 0,g=y?s:d,h=W(p=>{const v=typeof p=="function"?p(g):p;u(g,v)&&(y||x(v),i(v))},[y,i,g,u]);return[g,h]}var se=Q((n,s)=>e.jsx(F,{align:"center",...n,direction:"row",ref:s}));se.displayName="HStack";var[we,Oe,Se,Ie]=ie(),[ke,Fe]=ce({name:"PinInputContext",errorMessage:"usePinInputContext: `context` is undefined. Seems you forgot to all pin input fields within `<PinInput />`"}),K=n=>n==null?void 0:n.split("");function J(n,s){return(s==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(n)}function Ee(n={}){const{autoFocus:s,value:a,defaultValue:r,onChange:f,onComplete:i,placeholder:u="â—‹",manageFocus:d=!0,otp:x=!1,id:y,isDisabled:g,isInvalid:h,type:p="number",mask:j}=n,v=o.useId(),E=y??`pin-input-${v}`,c=Se(),[A,I]=o.useState(!0),[N,C]=o.useState(-1),[k,P]=be({defaultValue:K(r)||[],value:K(a),onChange:l=>f==null?void 0:f(l.join(""))});o.useEffect(()=>{if(s){const l=c.first();l&&requestAnimationFrame(()=>{l.node.focus()})}},[c]);const $=o.useCallback(l=>{if(!A||!d)return;const t=c.next(l,!1);t&&requestAnimationFrame(()=>{t.node.focus()})},[c,A,d]),R=o.useCallback((l,t,m=!0)=>{const b=[...k];b[t]=l,P(b),l!==""&&b.length===c.count()&&b.every(T=>T!=null&&T!=="")?i==null||i(b.join("")):m&&$(t)},[k,P,$,i,c]),oe=o.useCallback(()=>{var l;const t=Array(c.count()).fill("");P(t);const m=c.first();(l=m==null?void 0:m.node)==null||l.focus()},[c,P]),G=o.useCallback((l,t)=>{let m=t;return(l==null?void 0:l.length)>0&&(l[0]===t.charAt(0)?m=t.charAt(1):l[0]===t.charAt(1)&&(m=t.charAt(0))),m},[]);return{getInputProps:o.useCallback(l=>{const{index:t,...m}=l,b=D=>{const w=D.target.value,_=k[t],U=G(_,w);if(U===""){R("",t);return}if(w.length>2){if(J(w,p)){const z=w.split("").filter((De,le)=>le<c.count());P(z),z.length===c.count()&&(i==null||i(z.join("")))}}else J(U,p)&&R(U,t),I(!0)},X=D=>{var w;if(D.key==="Backspace"&&d)if(D.target.value===""){const _=c.prev(t,!1);_&&(R("",t-1,!1),(w=_.node)==null||w.focus(),I(!0))}else I(!1)},T=()=>{C(t)},ae=()=>{C(-1)},re=N===t;return{"aria-label":"Please enter your pin code",inputMode:p==="number"?"numeric":"text",type:j?"password":p==="number"?"tel":"text",...m,id:`${E}-${t}`,disabled:g,"aria-invalid":ue(h),onChange:H(m.onChange,b),onKeyDown:H(m.onKeyDown,X),onFocus:H(m.onFocus,T),onBlur:H(m.onBlur,ae),value:k[t]||"",autoComplete:x?"one-time-code":"off",placeholder:re?"":u}},[c,N,G,E,g,j,h,d,i,x,u,R,P,p,k]),id:E,descendants:c,values:k,setValue:R,setValues:P,clear:oe}}function Ae(n={},s=null){const{getInputProps:a}=Fe(),{index:r,register:f}=Ie();return a({...n,ref:de(f,s),index:r})}function te(n){const s=pe("PinInput",n),{children:a,...r}=fe(n),{descendants:f,...i}=Ee(r),u=he(a).map(d=>o.cloneElement(d,{__css:s}));return e.jsx(we,{value:f,children:e.jsx(ke,{value:i,children:u})})}te.displayName="PinInput";var S=Q(function(s,a){const r=Ae(s,a);return e.jsx(me.input,{...r,className:xe("chakra-pin-input",s.className)})});S.displayName="PinInputField";const Ne=()=>{const[n,s]=o.useState({code:null,error:null}),[a,r]=o.useState(!1),[f,i]=o.useState(!1);return{signup:async(d,x,y,g)=>{r(!0),s(null);const h=await fetch(Z+"/user/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:d,email:x,password:y,confirmPassword:g})}),p=await h.json();console.log(p),h.ok||(s({code:h.ok,error:p.resp}),r(!1)),h.ok&&(console.log("email is legit"),i(!0))},error:n,loading:a,showOTPComponent:f}},Re=({email:n})=>{const[s,a]=o.useState(""),r=ge(),f=u=>{a(u)},i=async u=>{u.preventDefault();const d=await fetch(Z+"/user/verifyOTP",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,otp:s})}),x=await d.json();console.log(x),d.ok&&(window.alert("Email verified successfully"),r("/login"))};return e.jsx(Y,{minH:"100vh",align:"center",justify:"center",bg:L("gray.50","gray.800"),children:e.jsxs(F,{spacing:4,w:"full",maxW:"sm",bg:L("white","gray.700"),rounded:"xl",boxShadow:"lg",p:6,my:10,children:[e.jsx(O,{children:e.jsx(ee,{lineHeight:1.1,fontSize:{base:"2xl",md:"3xl"},children:"Verify your Email"})}),e.jsx(O,{fontSize:{base:"sm",sm:"md"},color:L("gray.800","gray.400"),children:"We have sent code to your email"}),e.jsx(O,{fontSize:{base:"sm",sm:"md"},fontWeight:"bold",color:L("gray.800","gray.400"),children:n}),e.jsxs("form",{onSubmit:u=>i(u),children:[e.jsx(V,{children:e.jsx(O,{children:e.jsx(se,{children:e.jsxs(te,{value:s,onChange:f,children:[e.jsx(S,{}),e.jsx(S,{}),e.jsx(S,{}),e.jsx(S,{}),e.jsx(S,{}),e.jsx(S,{})]})})})}),e.jsx("br",{}),e.jsx(F,{spacing:6,children:e.jsx(ne,{type:"submit",bg:"blue.400",color:"white",_hover:{bg:"blue.500"},children:"Verify"})})]})]})})},Be=()=>{var c,A,I,N;const n=o.useRef(null),s=o.useRef(null),a=o.useRef(null),[r,f]=o.useState(""),[i,u]=o.useState(!1),[d,x]=o.useState(!0),y=ye();console.log("url "+y);const{signup:g,error:h,loading:p,showOTPComponent:j}=Ne();o.useEffect(()=>{h&&(h.code?q(h.error,{type:"error"}):q(h.error,{type:"error"}))},[h]);const v=async C=>{C.preventDefault(),await g(s.current.value,n.current.value,a.current.value,r)},E=C=>{f(C.target.value),C.target.value!=a.current.value?(console.log("password not matching"),x(!1)):x(!0)};return j?e.jsx(Re,{email:(c=n==null?void 0:n.current)==null?void 0:c.value}):e.jsxs(Y,{alignItems:"center",justifyContent:"center",minH:"100vh",children:[e.jsxs(F,{style:{border:"1px solid black"},p:5,rounded:6,minW:"300px",w:"30%",children:[e.jsx(F,{children:e.jsx(ee,{children:"Sign up"})}),e.jsx(je,{children:e.jsxs("form",{action:"",onSubmit:v,children:[e.jsxs(F,{children:[e.jsxs(V,{children:[e.jsx(M,{children:"Name"}),e.jsx(B,{type:"text",placeholder:"Name",ref:s})]}),e.jsxs(V,{children:[e.jsx(M,{children:"Email"}),e.jsx(B,{type:"email",placeholder:"example@gmail.com",ref:n})]}),e.jsxs(V,{children:[e.jsx(M,{children:"Enter Password"}),e.jsx(B,{type:"password",placeholder:"password",ref:a})]}),e.jsxs(V,{children:[e.jsx(M,{children:"Confirm Password"}),e.jsx(B,{type:"password",placeholder:"confirm password",value:r,onChange:E,onFocus:()=>u(!0),style:{borderColor:!d&&i?"red":""}})]}),e.jsx(ne,{type:"submit",isDisabled:!d||!((A=a.current)!=null&&A.value)||!((I=s.current)!=null&&I.value)||!((N=n.current)!=null&&N.value)||!r,isLoading:p,children:"Signup"})]}),e.jsxs(ve,{my:2,children:["Already have an account?"," ",e.jsx(Ce,{to:"/login",style:{textDecoration:"none",fontWeight:"600",color:"blue"},children:"Login"})]})]})})]}),e.jsx(Pe,{stacked:!0,position:"bottom-right",autoClose:2e3,progressStyle:{background:"green"}})]})};export{Be as default};
